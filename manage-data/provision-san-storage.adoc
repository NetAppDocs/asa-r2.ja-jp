---
sidebar: sidebar 
permalink: manage-data/provision-san-storage.html 
keywords: provision storage,san, create storage units, luns, namespaces, nvme, add host, add host initiators, map host, host mapping, create, ontap 
summary: ASA R2でONTAPストレージをプロビジョニングして、SAN（SCSIおよびNVMe）ホストが指定したストレージユニット（LUNおよびNVMeネームスペース）に対してデータの読み取りと書き込みを行えるようにします。 
searchtitle: ONTAP System Managerを使用したSANストレージのプロビジョニング| ASA R2 
---
= ASA R2システムでのONTAP SANストレージのプロビジョニング
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ストレージをプロビジョニングするときに、SANホストがASA R2ストレージシステムに対してデータの読み取りと書き込みを実行できるようにします。ストレージをプロビジョニングするには、ONTAPシステムマネージャを使用して、ストレージユニットを作成し、ホストイニシエータを追加し、ホストをストレージユニットにマッピングします。また、読み取り/書き込み処理を有効にするために、ホストで手順を実行する必要があります。



== ストレージユニットの作成

ASA R2システムでは、ストレージユニットによって、SANホストがデータ操作に使用できるストレージスペースが確保されます。ストレージユニットとは、SCSIホストの場合はLUN、NVMeホストの場合はNVMeネームスペースを指します。クラスタがSCSIホストをサポートするように設定されている場合は、LUNを作成するように求められます。NVMeホストをサポートするようにクラスタが設定されている場合は、NVMeネームスペースを作成するように求められます。ASA R2ストレージユニットの最大容量は128TBです。

link:https://hwu.netapp.com/["NetApp Hardware Universe"^]ASA R2システムの最新のストレージ制限については、を参照してください。

ホストイニシエータは、ストレージユニットの作成プロセスの一環としてストレージユニットに追加およびマッピングされます。また、link:provision-san-storage.html#add-host-initiators["ホストイニシエータの追加"]link:provision-san-storage.html#map-the-storage-unit-to-a-host["マッピング"]ストレージユニットの作成後にそれらをストレージユニットに追加することもできます。

.手順
. System Managerで、*[ストレージ]*を選択し、を選択しますimage:icon_add_blue_bg.png["青い背景を持つ長方形のアイコンと、白い文字の中央に「add」という単語が表示されます。"]。
. 新しいストレージ・ユニットの名前を入力します
. 作成する単位の数を入力します。
+
複数のストレージ・ユニットを作成する場合'各ユニットは同じ容量'ホスト・オペレーティング・システム'ホスト・マッピングを使用して作成されます

. ストレージユニットの容量を入力し、ホストオペレーティングシステムを選択します。
. 自動選択された*ホストマッピング*を受け入れるか、マッピング先のストレージユニットに別のホストグループを選択してください。
+
*ホスト マッピング* は、新しいストレージ ユニットがマップされるホスト グループを指します。新しいストレージ ユニットに選択したホストの種類に既存のホスト グループがある場合は、その既存のホスト グループがホスト マッピングに自動的に選択されます。自動的に選択されたホスト グループを受け入れることも、別のホスト グループを選択することもできます。

+
指定したオペレーティング システムで実行されているホストに既存のホスト グループが存在しない場合は、 ONTAPによって新しいホスト グループが自動的に作成されます。

. 次のいずれかを実行する場合は、*[その他のオプション]*を選択し、必要な手順を実行します。
+
[cols="2, 4a"]
|===
| オプション | 手順 


 a| 
デフォルトのQoSポリシーを変更する

ストレージユニットを作成するStorage Virtual Machine（VM）にデフォルトのQoSポリシーがまだ設定されていない場合、このオプションは使用できません。
 a| 
.. [ストレージと最適化]*で、*[Quality of Service（QoS）]*の横にあるを選択しますimage:icon_dropdown_arrow.gif["下向きを指している青い矢印のアイコン"]。
.. 既存の QoS ポリシーを選択してください。




 a| 
新しいQoSポリシーを作成します。
 a| 
.. [ストレージと最適化]*で、*[Quality of Service（QoS）]*の横にあるを選択しますimage:icon_dropdown_arrow.gif["下向きを指している青い矢印のアイコン"]。
.. [新しいポリシーを定義する]*を選択します。
.. 新しいQoSポリシーの名前を入力します。
.. QoS制限、QoS保証、またはその両方を設定します。
+
... 必要に応じて、* Limit *に、最大スループット制限、最大IOPS制限、またはその両方を入力します。
+
ストレージユニットに最大スループットとIOPSを設定すると、システムリソースへの影響が制限され、重要なワークロードのパフォーマンスが低下しないようになります。

... 必要に応じて、* Guarantee *に、最小スループット、最小IOPS、またはその両方を入力します。
+
ストレージユニットに最小スループットとIOPSを設定すると、競合するワークロードによる要求に関係なく、ストレージユニットは最小パフォーマンス目標を達成できます。



.. 「 * 追加」を選択します。




 a| 
デフォルトのパフォーマンスサービスレベルを変更
 a| 
.. [ストレージと最適化]*で、*[パフォーマンスサービスレベル]*の横にあるを選択しますimage:icon_dropdown_arrow.gif["下向きを指している青い矢印のアイコン"]。
.. [パフォーマンス]*を選択します。
+
ASA r2 システムには 2 つのパフォーマンス レベルがあります。デフォルトのパフォーマンス レベルは *Extreme* で、これは利用可能な最高レベルです。レベルを*パフォーマンス*に下げることもできます。





 a| 
新しいSCSIホストを追加します。
 a| 
.. [ホスト情報]*で、接続プロトコルとして*[SCSI]*を選択します。
.. ホストオペレーティングシステムを選択します。
.. [ホストマッピング]*で*[新しいホスト]*を選択します。
.. [FC]*または*[iSCSI]*を選択します。
.. 既存のホストイニシエータを選択するか、*イニシエータの追加*を選択して新しいホストイニシエータを追加します。
+
有効なFC WWPNの例は「01：02：03：04：0a：0b：0c：0d」です。有効なiSCSIイニシエータ名の例としては、「iqn.1995-08.com.example:string"」および「eui.0123456789abcdef」があります。





 a| 
新しいSCSIホストグループを作成する
 a| 
.. [ホスト情報]*で、接続プロトコルとして*[SCSI]*を選択します。
.. ホストオペレーティングシステムを選択します。
.. [ホストマッピング]*で*[新しいホストグループ]*を選択します。
.. ホストグループの名前を入力し、グループに追加するホストを選択します。




 a| 
新しいNVMeサブシステムを追加する
 a| 
.. [ホスト情報]*で、接続プロトコルとして*[NVMe]*を選択します。
.. ホストオペレーティングシステムを選択します。
.. [ホストマッピング]*で*[新しいNVMeサブシステム]*を選択します。
.. サブシステムの名前を入力するか、デフォルトの名前をそのまま使用します。
.. イニシエータの名前を入力します。
.. インバンド認証またはTransport Layer Security（TLS）を有効にする場合は、を選択しimage:icon_dropdown_arrow.gif["下向きを指している青い矢印のアイコン"]、オプションを選択します。
+
インバンド認証を使用すると、NVMeホストとASA R2システムの間でセキュアな双方向認証と一方向認証を確立できます。

+
TLSは、NVMe/TCPホストとASA R2システムの間でネットワーク経由で送信されるすべてのデータを暗号化します。

.. イニシエータをさらに追加する場合は、*[イニシエータの追加]*
+
ホストNQNの形式は、<nqn.yyyy-mm>のあとに完全修飾ドメイン名を指定する必要があります。年は1970年以降である必要があります。合計最大長は223である必要があります。有効なNVMeイニシエータの例はnqn.2014-08.com.example:stringです。



|===
. 「 * 追加」を選択します。


.次の手順
ストレージユニットが作成され、ホストにマッピングされます。これで、link:../data-protection/create-snapshots.html["スナップショットの作成"]ASA R2システム上のデータを保護できます。

.詳細情報
詳細については、をご覧ください link:../administer/manage-client-vm-access.html["ASA R2システムでのStorage Virtual Machineの使用方法"]。



== ホストイニシエータの追加

ASA R2システムには、いつでも新しいホストイニシエータを追加できます。イニシエータは、ホストがストレージユニットにアクセスしてデータ処理を実行できるようにします。

.開始する前に
ホストイニシエータの追加プロセス中にデスティネーションクラスタにホスト設定をレプリケートする場合は、クラスタがレプリケーション関係にある必要があります。必要に応じて、link:../data-protection/snapshot-replication.html#step-3-create-a-replication-relationship["レプリケーション関係を作成する"]ホストを追加したあとに実行できます。

SCSIホストまたはNVMeホストのホストイニシエータを追加します。

[role="tabbed-block"]
====
.SCSIホスト
--
.手順
. [ホスト]*を選択します。
. [SCSI]*を選択し、を選択しimage:icon_add_blue_bg.png["プラス記号の後に白い文字で追加された単語が続く青い四角形のアイコン"]ます。
. ホスト名を入力し、ホストオペレーティングシステムを選択して、ホストの説明を入力します。
. ホスト設定をデスティネーションクラスタにレプリケートする場合は、*[ホスト設定をレプリケート]*を選択してから、デスティネーションクラスタを選択します。
+
ホスト設定をレプリケートするには、クラスタがレプリケーション関係にある必要があります。

. 新規または既存のホストを追加します。
+
[cols="2"]
|===
| 新しいホストの追加 | 既存のホストを追加 


 a| 
.. [新しいホスト]*を選択します。
.. [FC]*または*[iSCSI]*を選択し、ホストイニシエータを選択します。
.. 必要に応じて、*ホストプロキシミティの設定*を選択します。
+
ホストのプロキシミティを設定すると、ONTAPがホストに最も近いコントローラを特定して、データパスの最適化とレイテンシの削減を実現できるようになります。これは、データをリモートサイトにレプリケートした場合にのみ該当します。Snapshotレプリケーションを設定していない場合は、このオプションを選択する必要はありません。

.. 新しいイニシエータを追加する必要がある場合は、*[イニシエータの追加]*を選択します。

 a| 
.. [既存のホスト]*を選択します。
.. 追加するホストを選択します。
.. 「 * 追加」を選択します。


|===
. 「 * 追加」を選択します。


.次の手順
ASA R2システムにSCSIホストが追加され、ホストをストレージユニットにマッピングする準備が整いました。

--
.NVMeホスト
--
.手順
. [ホスト]*を選択します。
. [NVMe]*を選択し、を選択しimage:icon_add_blue_bg.png["青い背景を持つ長方形のアイコンと、白い文字の中央に「add」という単語が表示されます。"]ます。
. NVMeサブシステムの名前を入力し、ホストオペレーティングシステムを選択して説明を入力します。
. [Add initiator]*を選択します。


.次の手順
NVMeホストがASA R2システムに追加され、ホストをストレージユニットにマッピングする準備が完了しました。

--
====


== ストレージ・ユニットのホストへのマッピング

ASA R2ストレージユニットを作成し、ホストイニシエータを追加したら、データの提供を開始するために、ホストをストレージユニットにマッピングする必要があります。ストレージ・ユニットは'ストレージ・ユニット作成プロセスの一環としてホストにマッピングされますまた、既存のストレージユニットを新規または既存のホストにいつでもマッピングできます。

.手順
. [ストレージ]*を選択します。
. マッピングするストレージ・ユニットの名前にカーソルを合わせます
. を選択しimage:icon_kabob.gif["3つの垂直な青い点"]、*[ホストにマッピング]*を選択します。
. ストレージユニットにマッピングするホストを選択し、*[マップ]*を選択します。


.次の手順
ストレージユニットがホストにマッピングされ、ホストでプロビジョニングプロセスを完了できる状態になります。



== ホスト側の完全なプロビジョニング

ストレージユニットを作成し、ホストイニシエータを追加し、ストレージユニットをマッピングしたら、ASA R2システムでデータの読み取りと書き込みを行う前に、ホストで実行する必要があります。

.手順
. FCおよびFC / NVMeの場合は、FCスイッチをWWPNでゾーニングします。
+
イニシエータごとに1つのゾーンを使用し、各ゾーンにすべてのターゲットポートを含めます。

. 新しいストレージユニットを検出します。
. ストレージ・ユニットとCREATE FILE SYSTEMを初期化します
. ホストがストレージユニットのデータを読み取りおよび書き込みできることを確認します。


.次の手順
プロビジョニングプロセスが完了し、データの提供を開始する準備ができました。これで、link:../data-protection/create-snapshots.html["スナップショットの作成"]ASA R2システム上のデータを保護できます。

.詳細情報
ホスト側の設定の詳細についてはlink:https://docs.netapp.com/us-en/ontap-sanhost/["ONTAP SANホストのドキュメント"^]、使用しているホストのを参照してください。
